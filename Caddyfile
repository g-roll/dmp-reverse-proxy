{
    # Admin API deaktivieren f端r Sicherheit
    admin off
    
    # Storage f端r SSL Zertifikate
    storage file_system {
        root /data
    }

    # On-demand TLS f端r dynamische Domains
    on_demand_tls {
        ask http://localhost:5000/verify
    }
}

# HTTPS Server
https:// {
    # TLS Konfiguration
    tls {
        on_demand
        protocols tls1.2 tls1.3
    }

    # Match f端r Container-spezifische Domains
    @container {
        host *
    }

    handle @container {
        reverse_proxy {$SERVICE_NAME:localhost}:{$PORT:80}
    }

    # Logging
    log {
        output stdout
        format json
    }
}

# HTTP zu HTTPS Redirect
http:// {
    redir https://{host}{uri} permanent
}
